webpackJsonp([27],{Qeu1:function(t,e){},Rgvq:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("3as3"),i=s("lbHh"),o=s.n(i),l={name:"userList",data:function(){return{userId:"",userName:"",groupId:"",groupName:"",list:[],total:0,page:1,limit:10,dialogVisible:!1,dialogTitle:"",userId_dialog:"",groupId_dialog:"",userIdList:[],groupIdList:[],addBtnStatus:!1,updateBtnStatus:!1,checkStatus:!0,oldUserId:"",oldGroupId:"",dialogVisible_batch:!1,dialogTitle_batch:"",userId_dialog_batch:"",groupId_dialog_batch:"",checkStatus_batch:!0}},mounted:function(){this.searchList(),this.getUserIdList(),this.getGroupIdList()},methods:{getUserIdList:function(){var t=this;this.$axios.get("auth/userList?start=&limit=&userId=&userName=&power=&structure="+this.$store.getters.info.role).then(function(e){t.userIdList=e.data.data.list}).catch(function(t){console.log(t)})},getGroupIdList:function(){var t=this;this.$axios.get("group/groupList?start=&limit=&groupId=&groupName=&type=&structure="+this.$store.getters.info.role).then(function(e){t.groupIdList=e.data.data.list}).catch(function(t){console.log(t)})},deleteUser2Group_batch:function(){var t=this,e={userId:this.userId_dialog_batch,groupId:this.groupId_dialog_batch,oldUserId:this.$store.getters.info.role};this.$axios.post("user2group/deleteUser2GroupBatch",e).then(function(){t.alertMessage("删除成功"),t.searchList()}).catch(function(e){t.alertMessage("删除失败"+e)}),this.dialogVisible_batch=!1},deleteUser2Group:function(t,e){var s=this;console.log(t,e),this.$confirm("是否确认删除该条记录？ 用户Id:"+e.userId+"  组Id:"+e.groupId,"确认删除",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){s.$axios.get("user2group/deleteUser2Group?userId="+e.userId+"&groupId="+e.groupId).then(function(){s.alertMessage("删除成功"),s.searchList()}).catch(function(t){s.alertMessage("删除失败"+t)})}).catch(function(t){console.log(t)})},updateUser2Group:function(){var t=this,e={userId:this.userId_dialog,groupId:this.groupId_dialog,oldUserId:this.oldUserId,oldGroupId:this.oldGroupId};this.$axios.post("user2group/updateUser2Group",e).then(function(){t.alertMessage("更新成功"),t.searchList()}).catch(function(e){t.alertMessage("更新失败"+e)}),this.dialogVisible=!1},addUser2Group_batch:function(){var t=this,e={userId:this.userId_dialog_batch,groupId:this.groupId_dialog_batch,oldUserId:this.$store.getters.info.role};this.$axios.post("user2group/addUser2GroupPatch",e).then(function(){t.alertMessage("添加成功"),t.searchList()}).catch(function(e){t.alertMessage("添加失败"+e)}),this.dialogVisible_batch=!1},addUser2Group:function(){var t=this,e={userId:this.userId_dialog,groupId:this.groupId_dialog};this.$axios.post("user2group/addUser2Group",e).then(function(){t.alertMessage("添加成功"),t.searchList()}).catch(function(e){t.alertMessage("添加失败"+e)}),this.dialogVisible=!1},alertMessage:function(t){var e=this.$createElement;this.$message({message:e("p",null,[e("span",{style:"color: teal"},t)])})},checkUserId_batch:function(){var t=this.userId_dialog_batch,e=/^\d+(\.\d+)?$/;if(null===t||""===t)this.alertMessage("用户ID不能为空");else if(-1==t.indexOf(",")&&-1==t.indexOf("-")&&e.test(t))this.checkStatus_batch=!1;else if(-1!=t.indexOf(",")&&-1!=t.indexOf("-"))this.alertMessage("不能同时包含,或-符号");else if(-1!=t.indexOf(",,"))this.alertMessage("不能同时包含连续多个,符号");else if(-1!=t.indexOf("--"))this.alertMessage("不能同时包含多个-符号");else if(0==t.indexOf(",")||t.lastIndexOf(",")==t.length-1)this.alertMessage(",符号不能位于开头或结尾");else if(e.test(t.replace(/,/g,"").replace(/-/g,""))){if(-1!=t.indexOf(","))this.checkStatus_batch=!1;else if(-1!=t.indexOf("-")){var s=t.split("-");2!=s.length?this.alertMessage("-只能有一个"):""===s[0]||""===s[1]?this.alertMessage("-前后必须有数字"):parseInt(s[0])>=parseInt(s[1])?this.alertMessage("-左侧数必须小于右侧"):parseInt(s[1])-parseInt(s[0])>1e3?this.alertMessage("批量用户数大于1000，请缩小范围"):this.checkStatus_batch=!1}}else this.alertMessage("有非数字，请检查")},checkGroupId_batch:function(){var t=this.groupId_dialog_batch,e=/^\d+(\.\d+)?$/;if(null===t||""===t)this.alertMessage("组ID不能为空");else if(-1==t.indexOf(",")&&-1==t.indexOf("-")&&e.test(t))this.checkStatus_batch=!1;else if(-1!=t.indexOf(",")&&-1!=t.indexOf("-"))this.alertMessage("不能同时包含,或-符号");else if(-1!=t.indexOf(",,"))this.alertMessage("不能同时包含连续多个,符号");else if(-1!=t.indexOf("--"))this.alertMessage("不能同时包含多个-符号");else if(0==t.indexOf(",")||t.lastIndexOf(",")==t.length-1)this.alertMessage(",符号不能位于开头或结尾");else if(e.test(t.replace(/,/g,"").replace(/-/g,""))){if(-1!=t.indexOf(","))this.checkStatus_batch=!1;else if(-1!=t.indexOf("-")){var s=t.split("-");2!=s.length?this.alertMessage("-只能有一个"):""===s[0]||""===s[1]?this.alertMessage("-前后必须有数字"):parseInt(s[0])>=parseInt(s[1])?this.alertMessage("-左侧数必须小于右侧"):parseInt(s[1])-parseInt(s[0])>1e3?this.alertMessage("批量组数量大于1000，请缩小范围"):this.checkStatus_batch=!1}}else this.alertMessage("有非数字，请检查")},checkUser2Group:function(){var t=this;if(console.log("准备检索"),this.userId_dialog!==this.oldUserId||this.groupId_dialog!==this.oldGroupId)return""===this.userId_dialog||""===this.groupId_dialog?(this.checkStatus=!0,void this.alertMessage("请选择用户id或组id")):void this.$axios.get("user2group/checkUser2Group?userId="+this.userId_dialog+"&groupId="+this.groupId_dialog).then(function(e){console.log(e),e.data.data?(t.checkStatus=!0,t.alertMessage("该用户和组关联已存在")):t.checkStatus=!1}).catch(function(t){console.log(t)})},showUpdateDialog:function(t,e){console.log(e),this.dialogTitle="修改关联",this.userId_dialog=e.userId,this.groupId_dialog=e.groupId,this.oldUserId=e.userId,this.oldGroupId=e.groupId,this.addBtnStatus=!1,this.updateBtnStatus=!0,this.dialogVisible=!0,this.checkStatus=!1},showAddDialog:function(){this.dialogTitle="添加关联",this.userId_dialog="",this.groupId_dialog="",this.addBtnStatus=!0,this.updateBtnStatus=!1,this.dialogVisible=!0,this.checkStatus=!0},showDialog_batch:function(){this.dialogTitle_batch="批量操作",this.userId_dialog_batch="",this.groupId_dialog_batch="",this.dialogVisible_batch=!0,this.checkStatus_batch=!0},handleClose:function(t){t()},axiosUrl:function(){var t=this,e=(this.page-1)*this.limit,s=this.limit;this.$axios.get("user2group/user2groupList?start="+e+"&limit="+s+"&userId="+this.userId+"&userName="+this.userName+"&groupId="+this.groupId+"&groupName="+this.groupName).then(function(e){t.list=e.data.data.list,t.total=e.data.data.total}).catch(function(t){console.log(t),o.a.remove("token"),location.reload()})},searchList:function(){this.page=1,this.axiosUrl()},changeList:function(t){t&&(this.limit=t.limit),this.axiosUrl()},clearInput:function(){this.userId="",this.userName="",this.groupId="",this.groupName="",this.searchList()},filterHandler:function(t,e,s){return e[s.property]===t}},components:{Pagination:a.a}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入用户ID",maxlength:"10","show-word-limit":""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入用户名称",maxlength:"10","show-word-limit":""},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入组ID",maxlength:"30","show-word-limit":""},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}}),t._v(" "),s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入组名称",maxlength:"50","show-word-limit":""},model:{value:t.groupName,callback:function(e){t.groupName=e},expression:"groupName"}}),t._v(" "),s("el-button",{staticClass:"searchBtn",attrs:{type:"success",loading:!1},on:{click:t.searchList}},[t._v("查 询")]),t._v(" "),s("el-button",{attrs:{type:"warning"},on:{click:t.clearInput}},[t._v("清 空")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:t.showAddDialog}},[t._v("创 建")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:t.showDialog_batch}},[t._v("批量操作")]),t._v(" "),[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[s("el-table-column",{attrs:{type:"index",label:"#"}}),t._v(" "),s("el-table-column",{attrs:{prop:"userId",label:"用户ID"}}),t._v(" "),s("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"groupId",label:"组ID"}}),t._v(" "),s("el-table-column",{attrs:{prop:"groupName",label:"组名"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return t.showUpdateDialog(e.$index,e.row)}}},[t._v("修改\n          ")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return t.deleteUser2Group(e.$index,e.row)}}},[t._v("删除\n          ")])]}}])})],1)],t._v(" "),s("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.page,limit:t.limit},on:{"update:page":function(e){t.page=e},"update:limit":function(e){t.limit=e},pagination:t.changeList}}),t._v(" "),s("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择用户"},on:{change:t.checkUser2Group},model:{value:t.userId_dialog,callback:function(e){t.userId_dialog=e},expression:"userId_dialog"}},t._l(t.userIdList,function(t){return s("el-option",{key:t.userId,attrs:{label:t.userId,value:t.userId}})}),1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择组"},on:{change:t.checkUser2Group},model:{value:t.groupId_dialog,callback:function(e){t.groupId_dialog=e},expression:"groupId_dialog"}},t._l(t.groupIdList,function(t){return s("el-option",{key:t.groupId,attrs:{label:t.groupId,value:t.groupId}})}),1)],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.addBtnStatus,expression:"addBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.addUser2Group}},[t._v("添 加")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.updateBtnStatus,expression:"updateBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.updateUser2Group}},[t._v("更 新")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:t.dialogTitle_batch,visible:t.dialogVisible_batch,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible_batch=e}}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入用户ID",maxlength:"256","show-word-limit":""},on:{focus:function(e){t.checkStatus_batch=!0},blur:t.checkUserId_batch},model:{value:t.userId_dialog_batch,callback:function(e){t.userId_dialog_batch=e},expression:"userId_dialog_batch"}})],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入组ID",maxlength:"256","show-word-limit":""},on:{focus:function(e){t.checkStatus_batch=!0},blur:t.checkGroupId_batch},model:{value:t.groupId_dialog_batch,callback:function(e){t.groupId_dialog_batch=e},expression:"groupId_dialog_batch"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible_batch=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary",disabled:t.checkStatus_batch},on:{click:t.addUser2Group_batch}},[t._v("批量创建")]),t._v(" "),s("el-button",{attrs:{type:"primary",disabled:t.checkStatus_batch},on:{click:t.deleteUser2Group_batch}},[t._v("批量删除")])],1)],1)],2)},staticRenderFns:[]};var n=s("VU/8")(l,r,!1,function(t){s("Qeu1")},"data-v-36d9f89a",null);e.default=n.exports}});
//# sourceMappingURL=27.11889598588ca437e787.js.map