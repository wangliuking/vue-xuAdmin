webpackJsonp([28],{FzAG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("3as3"),s=a("lbHh"),o=a.n(s),l={name:"userBookList",watch:{},data:function(){return{name:"",titles:["未添加用户","已添加用户"],list:[],total:0,page:1,limit:10,dialogVisible:!1,dialogTitle:"",id_dialog:"",name_dialog:"",addBtnStatus:!1,updateBtnStatus:!1,checkStatus:!0,bookIdDialog:!0,data:[],value:[],filterMethod:function(t,e){return e.label.indexOf(t)>-1}}},mounted:function(){this.searchList(),this.getUserIdList()},methods:{getUserIdList:function(){var t=this;this.$axios.get("auth/userList?start=&limit=&userId=&userName=&power=&structure=1").then(function(e){var a=[];e.data.data.list.forEach(function(t,e){a.push({label:t.userId,key:e})}),t.data=a}).catch(function(t){console.log(t)})},deleteUserBook:function(t){var e=this;this.$confirm("是否确认删除该通讯录？ id:"+t.id+" 名称:"+t.name,"确认删除",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){e.$axios.get("userbook/deleteUserBook?id="+t.id).then(function(){e.alertMessage("删除成功"),e.searchList()}).catch(function(t){e.alertMessage("删除失败"+t)})}).catch(function(t){console.log(t)})},update:function(){var t=this;if(""!==this.name_dialog)if(0!==this.value.length){var e=[];this.data.forEach(function(a){var i=a.label,s=a.key;t.value.forEach(function(t){t===s&&e.push(i)})});var a={id:this.id_dialog,name:this.name_dialog,userList:e};this.$axios.post("userbook/updateUserBook",a).then(function(){t.alertMessage("更新成功"),t.searchList()}).catch(function(e){t.alertMessage("更新失败"+e)}),this.dialogVisible=!1}else this.alertMessage("未选择任何用户");else this.alertMessage("通讯录名称不能为空")},add:function(){var t=this;if(""!==this.name_dialog)if(0!==this.value.length){var e=[];this.data.forEach(function(a){var i=a.label,s=a.key;t.value.forEach(function(t){t===s&&e.push(i)})});var a={id:this.id_dialog,name:this.name_dialog,userList:e};this.$axios.post("userbook/addUserBook",a).then(function(){t.alertMessage("添加成功"),t.searchList()}).catch(function(e){t.alertMessage("添加失败"+e)}),this.dialogVisible=!1}else this.alertMessage("未选择任何用户");else this.alertMessage("通讯录名称不能为空")},alertMessage:function(t){var e=this.$createElement;this.$message({message:e("p",null,[e("span",{style:"color: teal"},t)])})},checkWord:function(){var t=this;if(""===this.id_dialog)return this.checkStatus=!0,void this.alertMessage("通讯录ID不能为空");this.$axios.get("userbook/checkId?id="+this.id_dialog).then(function(e){console.log(e),e.data.data?(t.checkStatus=!0,t.alertMessage("通讯录ID已存在")):t.checkStatus=!1}).catch(function(t){console.log(t)})},showUpdateDialog:function(t){this.dialogTitle="修改通讯录",this.bookIdDialog=!1,this.id_dialog=t.id,this.name_dialog=t.name;var e=t.userBookDetail,a=[];this.data.forEach(function(t){var i=t.label,s=t.key;e.forEach(function(t){t.userId===i&&a.push(s)})}),this.value=a,this.addBtnStatus=!1,this.updateBtnStatus=!0,this.dialogVisible=!0,this.checkStatus=!1},showAddDialog:function(){this.dialogTitle="添加通讯录",this.bookIdDialog=!0,this.name_dialog="",this.value=[],this.addBtnStatus=!0,this.updateBtnStatus=!1,this.dialogVisible=!0,this.checkStatus=!0},handleClose:function(t){t()},axiosUrl:function(){var t=this,e=(this.page-1)*this.limit,a=this.limit;this.$axios.get("userbook/userBookList?start="+e+"&limit="+a+"&name="+this.name).then(function(e){t.list=e.data.data.list,t.total=e.data.data.total}).catch(function(t){console.log(t),o.a.remove("token"),location.reload()})},searchList:function(){this.page=1,this.axiosUrl()},changeList:function(t){t&&(this.limit=t.limit),this.axiosUrl()},clearInput:function(){this.name="",this.searchList()},filterHandler:function(t,e,a){return e[a.property]===t}},components:{Pagination:i.a}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入通讯录名称",maxlength:"50","show-word-limit":""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),a("el-button",{staticClass:"searchBtn",attrs:{type:"success",loading:!1},on:{click:t.searchList}},[t._v("查 询")]),t._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:t.clearInput}},[t._v("清 空")]),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:t.showAddDialog}},[t._v("创 建")])],1),t._v(" "),a("el-row",t._l(t.list,function(e,i){return a("el-col",{key:i,staticStyle:{"margin-bottom":"20px"},attrs:{span:8}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(a){return t.showUpdateDialog(e)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(a){return t.deleteUserBook(e)}}},[t._v("删除")])],1),t._v(" "),a("div",{staticClass:"text item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"300",data:e.userBookDetail}},[a("el-table-column",{attrs:{prop:"userId",label:"用户Id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"名称",width:"180"}})],1)],1)])],1)}),1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.page,limit:t.limit},on:{"update:page":function(e){t.page=e},"update:limit":function(e){t.limit=e},pagination:t.changeList}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"35%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.bookIdDialog,expression:"bookIdDialog"}],staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入通讯录id",maxlength:"30","show-word-limit":""},on:{focus:function(e){t.checkStatus=!0},blur:t.checkWord},model:{value:t.id_dialog,callback:function(e){t.id_dialog=e},expression:"id_dialog"}})],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入通讯录名称",maxlength:"30","show-word-limit":""},model:{value:t.name_dialog,callback:function(e){t.name_dialog=e},expression:"name_dialog"}})],1)],1),t._v(" "),a("el-row",[a("el-transfer",{attrs:{filterable:"","filter-method":t.filterMethod,"filter-placeholder":"请输入用户id",titles:t.titles,data:t.data},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.addBtnStatus,expression:"addBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.add}},[t._v("添 加")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.updateBtnStatus,expression:"updateBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.update}},[t._v("更 新")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(l,n,!1,function(t){a("RYMz")},"data-v-2a09a53c",null);e.default=r.exports},RYMz:function(t,e){}});
//# sourceMappingURL=28.1c7d10ee2478d664f2f9.js.map