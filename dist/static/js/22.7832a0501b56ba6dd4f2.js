webpackJsonp([22],{"TR/P":function(t,e){},Z1MN:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("3as3"),i=s("lbHh"),o=s.n(i),l={name:"userList",data:function(){return{userId:"",userName:"",power:"",list:[],total:0,page:1,limit:10,dialogVisible:!1,dialogTitle:"",userId_dialog:"",userName_dialog:"",password_dialog:"",options:[],power_dialog:"",addBtnStatus:!1,updateBtnStatus:!1,checkStatus:!0,oldUserId:""}},mounted:function(){this.searchList(),this.getStructureList()},methods:{getStructureList:function(){var t=this;this.$axios.get("structure/selectStructureList?structure="+this.$store.getters.info.role).then(function(e){console.log(e),t.options=e.data.nodeList}).catch(function(t){console.log(t)})},deleteWebUser:function(t,e){var s=this;console.log(t,e),this.$confirm("是否确认删除该条记录？ 账号:"+e.userId+"  名称:"+e.userName,"确认删除",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){s.$axios.get("auth/deleteWebUser?userId="+e.userId).then(function(){s.alertMessage("删除成功"),s.searchList()}).catch(function(t){s.alertMessage("删除失败"+t)})}).catch(function(t){console.log(t)})},updateWebUser:function(){var t=this,e={userId:this.userId_dialog,userName:this.userName_dialog,password:this.password_dialog,power:this.power_dialog,oldUserId:this.oldUserId};this.$axios.post("auth/updateWebUser",e).then(function(){t.alertMessage("更新成功"),t.searchList()}).catch(function(e){t.alertMessage("更新失败"+e)}),this.dialogVisible=!1},addWebUser:function(){var t=this,e={userId:this.userId_dialog,userName:this.userName_dialog,password:this.password_dialog,power:this.power_dialog};this.$axios.post("auth/addWebUser",e).then(function(){t.alertMessage("添加成功"),t.searchList()}).catch(function(e){t.alertMessage("添加失败"+e)}),this.dialogVisible=!1},alertMessage:function(t){var e=this.$createElement;this.$message({message:e("p",null,[e("span",{style:"color: teal"},t)])})},checkWebUserId:function(){var t=this;this.$axios.get("auth/checkWebUserId?userId="+this.userId_dialog).then(function(e){console.log(e),e.data.data&&t.userId_dialog!==t.oldUserId?(t.checkStatus=!0,t.alertMessage("账号已存在")):""===t.userId_dialog?(t.checkStatus=!0,t.alertMessage("账号不能为空")):t.checkStatus=!1}).catch(function(t){console.log(t)})},showUpdateDialog:function(t,e){console.log(e),this.dialogTitle="修改账号",this.userId_dialog=e.userId,this.userName_dialog=e.userName,this.password_dialog=e.password,this.power_dialog=e.power,this.oldUserId=e.userId,this.addBtnStatus=!1,this.updateBtnStatus=!0,this.dialogVisible=!0,this.checkStatus=!1},showAddDialog:function(){this.dialogTitle="添加账号",this.userId_dialog="",this.userName_dialog="",this.password_dialog="",this.power_dialog="",this.addBtnStatus=!0,this.updateBtnStatus=!1,this.dialogVisible=!0,this.checkStatus=!0},handleClose:function(t){t()},axiosUrl:function(){var t=this,e=(this.page-1)*this.limit,s=this.limit;this.$axios.get("auth/webuserList?start="+e+"&limit="+s+"&userId="+this.userId+"&userName="+this.userName+"&power="+this.power+"&structure="+this.$store.getters.info.role).then(function(e){t.list=e.data.data.list,t.total=e.data.data.total}).catch(function(t){console.log(t),o.a.remove("token"),location.reload()})},searchList:function(){this.page=1,this.axiosUrl()},changeList:function(t){t&&(this.limit=t.limit),this.axiosUrl()},clearInput:function(){this.userId="",this.userName="",this.power="",this.searchList()},filterHandler:function(t,e,s){return e[s.property]===t},formatter:function(t,e){return t.userName},filterTag:function(t,e){return e.loginStatus===t}},components:{Pagination:a.a}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入用户ID",maxlength:"10","show-word-limit":""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入用户名称",maxlength:"10","show-word-limit":""},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),s("el-input",{staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入组织架构",maxlength:"10","show-word-limit":""},model:{value:t.power,callback:function(e){t.power=e},expression:"power"}}),t._v(" "),s("el-button",{staticClass:"searchBtn",attrs:{type:"success",loading:!1},on:{click:t.searchList}},[t._v("查 询")]),t._v(" "),s("el-button",{attrs:{type:"warning"},on:{click:t.clearInput}},[t._v("清 空")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:t.showAddDialog}},[t._v("创 建")]),t._v(" "),[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[s("el-table-column",{attrs:{type:"index",label:"#"}}),t._v(" "),s("el-table-column",{attrs:{prop:"userId",label:"账号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"userName",label:"名称"}}),t._v(" "),s("el-table-column",{attrs:{prop:"power",label:"组织架构"}}),t._v(" "),s("el-table-column",{attrs:{prop:"loginTime",label:"最近登录时间",sortable:"","filter-method":t.filterHandler}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return t.showUpdateDialog(e.$index,e.row)}}},[t._v("修改\n          ")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return t.deleteWebUser(e.$index,e.row)}}},[t._v("删除\n          ")])]}}])})],1)],t._v(" "),s("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.page,limit:t.limit},on:{"update:page":function(e){t.page=e},"update:limit":function(e){t.limit=e},pagination:t.changeList}}),t._v(" "),s("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入账号",maxlength:"30","show-word-limit":""},on:{focus:function(e){t.checkStatus=!0},blur:t.checkWebUserId},model:{value:t.userId_dialog,callback:function(e){t.userId_dialog=e},expression:"userId_dialog"}})],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入名称",maxlength:"50","show-word-limit":""},model:{value:t.userName_dialog,callback:function(e){t.userName_dialog=e},expression:"userName_dialog"}})],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-input",{staticClass:"dialogInput",attrs:{type:"text",placeholder:"请输入密码",maxlength:"30","show-word-limit":"","show-password":""},model:{value:t.password_dialog,callback:function(e){t.password_dialog=e},expression:"password_dialog"}})],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择组织结构"},model:{value:t.power_dialog,callback:function(e){t.power_dialog=e},expression:"power_dialog"}},t._l(t.options,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.addBtnStatus,expression:"addBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.addWebUser}},[t._v("添 加")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.updateBtnStatus,expression:"updateBtnStatus"}],attrs:{type:"primary",disabled:t.checkStatus},on:{click:t.updateWebUser}},[t._v("更 新")])],1)],1)],2)},staticRenderFns:[]};var n=s("VU/8")(l,r,!1,function(t){s("TR/P")},"data-v-414ee07c",null);e.default=n.exports}});
//# sourceMappingURL=22.7832a0501b56ba6dd4f2.js.map